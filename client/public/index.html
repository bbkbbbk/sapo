<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SAPO Login</title>
    <script defer src="/__/firebase/8.0.2/firebase-app.js"></script>
    <script defer src="/__/firebase/init.js"></script>
    <script src="https://static.line-scdn.net/liff/edge/versions/2.3.0/sdk.js"></script>
    <style media="screen">
    </style>
  </head>
  <body>
    <div>
      <div id="responseArea"></div>
    </div>
    <script>
      const liffId = "1655240271-nKRloDyw"
      const sapoURL = "https://sapo-wb87j.ondigitalocean.app/signup?"

      function runApp() {
        liff.getProfile().then(profile => {
          let userId = profile.userId
          let userName = profile.userName
          let url = sapoURL+ "uid=" + userId + "&name=" + userName
          window.location = url;
        })
      }

      liff.init({ liffId: liffId }, () => {
        if (liff.isLoggedIn()) {
          runApp()
        } else {
          liff.login();
        }
      }, err => console.error(err.code, error.message));
    </script>
  </body>
</html>
